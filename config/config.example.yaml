# CT-System Configuration Example
# Copy this file to config.yaml and update with your values

# Server configuration
server:
  port: 8443  # В proxy mode это внутренний upstream-порт web-ui (внешний порт обслуживает nginx)
  tls:
    enabled: true  # ⚠ В proxy mode обычно не используется (TLS терминирует nginx)
    cert_path: "pki/server/web-ui.fullchain.crt"  # ⚠ Не используется, если tls.enabled=false в proxy mode
    key_path: "pki/server/web-ui.key"  # ⚠ Не используется, если tls.enabled=false в proxy mode
    ca_path: "pki/ca/ca.crt"  # ⚠ Для входящего HTTPS web-ui не используется (reserved)
  timeouts:
    read: 60s
    write: 60s
    idle: 120s
    read_header: 5s
    shutdown_grace: 10s
  limits:
    max_header_bytes: 1048576
  http2:
    # ⚠ В proxy mode не влияет на внешний HTTP/2 (его обслуживает nginx на edge)
    max_concurrent_streams: "250"
    initial_window_size: "64k"
    max_frame_size: "16k"
    max_header_list_size: "1M"
    idle_timeout_seconds: 120
    max_upload_buffer_per_conn: "1M"
    max_upload_buffer_per_stream: "1M"

# Reverse proxy configuration (точка входа: nginx -> web-ui)
proxy:
  enabled: false  # Включает proxy-aware режим приложения (на текущем этапе зарезервировано, поведение в разработке)
  trust_forward_headers: false  # Доверять X-Forwarded-* только от trusted источников (на текущем этапе зарезервировано)
  trusted_hops: 1  # Кол-во прокси-хопов до клиента (на текущем этапе зарезервировано)
  trusted_cidrs:
    - "127.0.0.1/32"  # Разрешенный источник forwarded headers (на текущем этапе зарезервировано)
    - "10.0.0.0/8"  # Разрешенный источник forwarded headers (на текущем этапе зарезервировано)
  static_via_nginx: false  # true: статику отдает nginx, backend static routes не нужны (на текущем этапе зарезервировано)

# Database configuration
database:
  engine: "mysql"  # mysql, oracle (future)
  mysql:
    host: "localhost"
    port: 3306
    user: "ct_web"
    password: "test_password"
    database: "ct_system"
    charset: "utf8mb4"
    parse_time: true
    max_open_conns: 25
    max_idle_conns: 5
    conn_max_lifetime: 300s  # 5 minutes
    conn_max_idle_time: 60s  # 1 minute
  oracle:
    host: "localhost"
    port: 1521
    user: "example"
    password: "example"
    database: "example"

# Security configuration
security:
  jwt_secret: "change-this-secret-key-in-production"
  session_secret: "change-this-session-secret-in-production"
  csrf_secret: "change-this-csrf-secret-in-production"
  bcrypt_cost: 10
  session_cookie_name: "ct_session"
  session_cookie_secure: false  # Set to true in production with HTTPS
  session_cookie_http_only: true
  session_cookie_same_site: "Lax"  # Strict, Lax, None
  session_max_age: 86400  # 24 hours in seconds
  remember_me_days: 7  # Days for "Remember Me" cookie

rate_limit:
  login:
    requests_per_minute: 5
    burst: 5
  api:
    requests_per_second: 100
    burst: 100

# Logging configuration
logging:
  level: "info"  # debug, info, warn, error
  format: "json"  # json, text
  output: "stdout"  # stdout, file, both
  error_path: "/var/log/ct-system.log"
  max_size_mb: 100  # MB
  max_backups: 5
  max_age_days: 30  # days
  compress: true
  access_path: "/var/log/ct-system-access.log"
  access_max_size_mb: 50
  access_max_backups: 10
  access_max_age_days: 7
  audit_path: "/var/log/ct-system-audit.log"
  audit_max_size_mb: 100
  audit_max_backups: 5
  audit_max_age_days: 30

# Daemon configuration
daemon:
  path: "/home/trader/trader"
  check_interval: 5s  # How often to check daemon status

# Application settings
app:
  name: "CT-System"
  version: "1.0.0"
  timezone: "UTC"
  default_language: "en"

