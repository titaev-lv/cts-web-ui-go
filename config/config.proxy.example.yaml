# CT-System Configuration (Proxy mode with nginx)
# Copy this file to config.yaml for proxy profile usage

# Server configuration
server:
  port: 8080
  tls:
    enabled: false
  timeouts:
    read: 60s
    write: 60s
    idle: 120s
    read_header: 5s
    shutdown_grace: 10s
  limits:
    max_header_bytes: 1048576

# Reverse proxy configuration
proxy:
  enabled: true
  trust_forward_headers: true
  trusted_hops: 1 
  trusted_cidrs:
    - "127.0.0.1/32"
    - "172.16.0.0/12"
  static_via_nginx: true

# Databases configuration
databases:
  system:
    engine: "mysql"
    mysql:
      host: "ct-system-mysql"
      port: 3306
      user: "root"
      password: "root"
      database: "ct_system"
      charset: "utf8mb4"
      parse_time: true
      pool:
        max_open_conns: 25
        max_idle_conns: 5
        conn_max_lifetime: 300s
        conn_max_idle_time: 60s
      tls:
        enabled: false
        ca_path: ""
        cert_path: ""
        key_path: ""
      retry:
        max_attempts: 3
        initial_delay: 1s
        max_delay: 5s
        multiplier: 2.0
  audit:
    engine: "clickhouse"
    clickhouse:
      host: clickhouse-prod.titaev.pro
      port: 8123
      database: crypto
      username: crypto_user
      password: secure_password_here
      use_tls: true
      connect_timeout: 10
      max_retries: 3
      compression: true
      max_batch_size: 10000
      replication_factor: 1
  quotes:
    engine: "clickhouse"
    clickhouse:
      host: clickhouse-prod.titaev.pro
      port: 8123
      database: crypto
      username: crypto_user
      password: secure_password_here
      use_tls: true
      connect_timeout: 10
      max_retries: 3
      compression: true
      max_batch_size: 10000
      replication_factor: 1

# Security configuration
security:
  csrf:
    secret: "dev-csrf-secret-change-in-production"
    enabled: false
    cookie_name: "csrf_token"
    header_name: "X-CSRF-Token"
    trusted_origins: []
  session:
    secret: "dev-session-secret-change-in-production"
    cookie_name: "ct_session"
    cookie_secure: false
    cookie_http_only: true
    cookie_same_site: "Lax"
    max_age: 86400
    remember_me_days: 7
  bcrypt_cost: 12

rate_limit:
  login:
    requests_per_minute: 5
    burst: 5
  api:
    requests_per_second: 120
    burst: 100

# Logging configuration
logging:
  level: "debug"  # debug for development
  format: "json"  # json for better parsing in production
  compress: false
  output: "both"  # stdout for docker logs, file for persistence
  error_path: "/var/log/web-ui/error.log"
  access_path: "/var/log/web-ui/access.log"
  audit_path: "/var/log/web-ui/audit.log"
  access_to_stdout: true
  out_request_to_stdout: true
  audit_to_stdout: true
  max_size_mb: 100
  max_backups: 5
  max_age_days: 30
